redis:
  image: redis:{{ version }}
  ports:
    - "${REDIS_PORT:-{{ port }}}:6379"
{% if persistence %}
  volumes:
    - redis_data:/data
{% endif %}
  command: redis-server --appendonly {{ persistence ? 'yes' : 'no' }}
  healthcheck:
    test: ["CMD", "redis-cli", "ping"]
    interval: 10s
    timeout: 5s
    retries: 5
  restart: unless-stopped
